version: '3'

services:
  jellyfin:
    image: jellyfin/jellyfin:10.8.9
    restart: unless-stopped
    ports:
      - 8096:8096
    container_name: media-jellyfin
    volumes:
      - /home/leon/Media:/media
      - ./jellyfin/config:/config
      - ./jellyfin/cache:/cache
    group_add:
      - "video"
    devices:
      # VAAPI Devices
      - /dev/dri/renderD128:/dev/dri/renderD128
      - /dev/dri/card0:/dev/dri/card0

  navidrome:
    image: deluan/navidrome:0.49.3
    container_name: media-navidrome
    restart: unless-stopped
    environment:
      ND_SCANSCHEDULE: 1h
      ND_CONFIGFILE: "/data/navidrome.toml"
    volumes:
      - "./navidrome:/data"
      - "/home/leon/Media/music:/music:ro"
    ports:
      - "4533:4533"

  transmission-openvpn:
    image: haugene/transmission-openvpn:4.3.2
    container_name: media-transmission-openvpn
    mem_limit: 2g
    memswap_limit: 2g
    restart: unless-stopped
    cap_add:
      - NET_ADMIN
    volumes:
      - /home/leon/Media:/data
    environment:
      - OPENVPN_PROVIDER=${OPENVPN_PROVIDER}
      - OPENVPN_CONFIG=${OPENVPN_CONFIG}
      - OPENVPN_USERNAME=${OPENVPN_USERNAME}
      - OPENVPN_PASSWORD=${OPENVPN_PASSWORD}
      - LOCAL_NETWORK=192.168.0.0/16
      - OPENVPN_OPTS=--inactive 3600 --ping 10 --ping-exit 60
    sysctls:
        - "net.ipv6.conf.all.disable_ipv6=0"
    ports:
      - 9091:9091

  # nzbget:
    # image: linuxserver/nzbget:version-v21.1
    # restart: unless-stopped
    # container_name: media-nzbget
    # environment:
      # - PUID=1000
      # - PGID=1000
      # - TZ=Europe/Europe
    # volumes:
      # - ./nzbget:/config
      # - /home/leon/Media/nzbget/downloads:/downloads
      # - /home/leon/Media/completed:/downloads/completed
    # ports:
      # - 6789:6789

  radarr:
    image: linuxserver/radarr:4.3.2
    container_name: media-radarr
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Amsterdam
    volumes:
      - ./radarr:/config
      - /home/leon/Media/movies:/movies
      - /home/leon/Media/shows:/tv
      - /home/leon/Media/downloads:/downloads
      - /home/leon/Media/completed:/data/completed
    ports:
      - 7878:7878

  sonarr:
    image: linuxserver/sonarr:3.0.9
    container_name: media-sonarr
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Amsterdam
    volumes:
      - ./sonarr:/config
      - /home/leon/Media/movies:/movies
      - /home/leon/Media/shows:/tv
      - /home/leon/Media/downloads:/downloads
      - /home/leon/Media/completed:/data/completed
    ports:
      - 8989:8989

  jackett:
    image: linuxserver/jackett:0.20.3063
    container_name: media-jackett
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Amsterdam
    volumes:
      - ./jackett:/config
      - /home/leon/Media/downloads:/downloads
    ports:
      - 9117:9117

  bazarr:
    image: linuxserver/bazarr:1.1.4
    container_name: media-bazarr
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Amsterdam
    volumes:
      - ./bazarr:/config
      - /home/leon/Media/movies:/movies
      - /home/leon/Media/shows:/tv
      - /home/leon/Media/downloads:/downloads
      - /home/leon/Media/completed:/data/completed
    ports:
      - 6767:6767

  lidarr:
    image: linuxserver/lidarr:1.0.2
    container_name: media-lidarr
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Amsterdam
    volumes:
      - /home/leon/Services/docker-library/media-stack/lidarr:/config
      - /home/leon/Media/music:/music
      - /home/leon/Media/downloads:/downloads
      - /home/leon/Media/completed:/data/completed
    ports:
      - 8686:8686

  prowlarr:
    image: linuxserver/prowlarr:1.1.3
    container_name: media-prowlarr
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Amsterdam
    volumes:
      - /home/leon/Services/docker-library/media-stack/prowlarr:/config
    ports:
      - 9696:9696
